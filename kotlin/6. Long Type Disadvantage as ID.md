# Primary keyë¡œì¨ì˜ Long Type ë‹¨ì 

### ğŸ“Œ Long ë‹¨ì 
1. ìœ ì¼ì„± ë³´ì¥ í•œê³„ (ê°ê¸° ë‹¤ë¥¸ Entityë¼ë¦¬ ê°™ì€ idê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤)
2. UUID ê°œìˆ˜ >>>> Long ê°œìˆ˜ (í˜„ì €íˆ ì‘ìŒ)

### ğŸ“Œ Long ì¥ì 
1. Long ìˆœì„œ ìˆì–´ ì •ë ¬ ì‹œ ì„±ëŠ¥ìƒ ì´ì  
2. UUIDì— ë¹„í•´ ë°ì´í„° í¬ê¸° ì‘ìŒ

<hr>
<br>

## ê³µë™ Primary Key ìƒì„± ë°©ì‹ 

## ğŸ“Œ @GeneratedValue ì‚¬ìš©í•˜ì§€ ë§ì!
    nullalble typeì„ ìœ ë„í•¨

- @GeneratedValue: Entity ìƒì„±í•˜ê³  ì˜ì†í™”ì‹œ ìë™ìœ¼ë¡œ primary keyë¥¼ ìƒì„±

<br>

### âš¡ï¸ ì²«ì§¸, Nullable íƒ€ì…ì„ ìœ ë„í•œë‹¤

JPA save()í•¨ìˆ˜ë¥¼ ì‚´í´ë³´ì
```java
@Transactional
@Override
public <S extends T> S save(S entity) {

  Assert.notNull(entity, "Entity must not be null.");

  if (entityInformation.isNew(entity)) {
    em.persist(entity);
    return entity;
  } else {
    return em.merge(entity);
  }
}
```

### ë‘ ê°€ì§€ ê°ˆë¦¼ê¸¸ë¡œ ë‚˜ë‰¨
  - EntityManager.persist(): ìƒˆë¡­ê²Œ ìƒì„±ëìœ¼ë©´ ì‹¤í–‰
  - EnityManager.merge(): ê¸°ì¡´ì˜ ì¡´ì¬í•˜ë©´ ì‹¤í–‰

### ìƒˆë¡­ê²Œ ìƒì„±ëœ ê°ì²´ì„ì€ ì–´ë–»ê²Œ í™•ì¸í• ê¹Œ
  - JpaMetamodelEntityInformation > AbstractEntityInformation.isNewë¥¼ í†µí•´ íŒë‹¨ëœë‹¤.

```java
public boolean isNew(T entity) {

  ID id = getId(entity);
  Class<ID> idType = getIdType();

  if (!idType.isPrimitive()) {
    return id == null;
  }

  if (id instanceof Number) {
    return ((Number) id).longValue() == 0L;
  }

  throw new IllegalArgumentException(String.format("Unsupported primitive id type %s", idType));
}
```

### ìƒˆë¡œìš´ ê°ì²´ íŒë‹¨ ë°©ë²•
- ì°¸ì¡°íƒ€ì…(reperence type) ID: null ì—¬ë¶€
- ìˆ«ìí˜• íƒ€ì…(Long, int, Interger..) ID: 0 ì—¬ë¶€

### ì¦‰ Primary Keyê°€ nullableí•œ íƒ€ì…ì´ë¼ëŠ” ê²ƒ!
- DBì—ì„œ PKì— Not Nullì„ ê°•ì œí•˜ê³  Entityì—ì„œë„ PKê°€ Not Nullì¸ê²ƒì´ ì •ìƒì ì´ë‹¤.

<br>

### âš¡ï¸ ë‘˜ì§¸, ìƒì„±í•œ ê°’ê³¼ ì˜ì†í™”ëœ ê°’ì´ ë‹¤ë¥´ë‹¤
EntityëŠ” ì‹ë³„ìì˜ ê°’ì„ ë¹„êµí•´ ë™ì¼ì„±ì„ íŒë‹¨í•œë‹¤. <br>
ê·¸ëŸ°ë° IDê°€ Long íƒ€ì…ì¸ EntityëŠ” ì˜ì†í™” ì „ì—ëŠ” 0ìœ¼ë¡œ ì´ˆê¸°í™” ëœë‹¤. <br>
ê·¸ëŸ¼ ì´ Entityë“¤ì€ ëª¨ë‘ ê°™ì€ Entityë¼ê³  í•´ì•¼í• ê¹Œ? ë‹¹ì—°íˆ ì•„ë‹ˆì§€ ğŸ™…â€â™‚ï¸

<br>

### âš¡ï¸ ì…‹ì§¸, ë°ì´í„°ë² ì´ìŠ¤ì— ì±„ë²ˆ ìœ ë°œ
@GeneratedValueì˜ ì „ëµ(auto_increament, sequence..)ë“¤ì€ DBì— ì±…ì„ì„ ì „ê°€í•˜ê³  ë¶€í•˜ë¥¼ ìœ ë°œí•œë‹¤ <br>
ëŒ€ëŸ‰ì˜ íŠ¸ë˜í”½ì´ ìŸì•„ì§€ëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” ì´ëŸ° ì±„ë²ˆì´ ìƒë‹¹í•œ ë¶€ë‹´ì´ ë  ìˆ˜ ìˆë‹¤.